:host {
  --shell-bg: #f6f8fb;
  --sidebar-bg: #f1f4f8;
  --sidebar-gradient-to: #e8edf4;
  --sidebar-text: #0f172a;
  --sidebar-muted: #475467;
  --sidebar-active: #0ea5e9;
  --content-text: #0f172a;
  --border-color: #d0d5dd;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  color: var(--content-text);
}

:host-context(.dark-theme) {
  --shell-bg: #0a0f1a;
  --sidebar-bg: #0f172a;
  --sidebar-gradient-to: #111b2f;
  --sidebar-text: #e2e8f0;
  --sidebar-muted: #94a3b8;
  --sidebar-active: #38bdf8;
  --content-text: #e5e7eb;
  --border-color: #273447;
}

.shell {
  min-height: 100vh;
  display: grid;
  grid-template-columns: 272px 1fr;
  background: radial-gradient(
    circle at 15% 20%,
    color-mix(in srgb, var(--mks-surface) 72%, var(--shell-bg)),
    var(--shell-bg)
  );
  position: relative;
}

.shell.sidebar-collapsed {
  grid-template-columns: 86px 1fr;
}

.shell.tenant-portal {
  --shell-bg: #eef7fb;
  --sidebar-bg: #edf2f7;
  --sidebar-gradient-to: #e3e9f1;
  --sidebar-active: #0ea5e9;
}

.shell.control-plane {
  --shell-bg: #fff5ea;
  --sidebar-gradient-to: #fff0e5;
  --sidebar-active: #f97316;
  --content-text: #1f2937;
}

:host-context(.dark-theme) .shell {
  background: radial-gradient(circle at 15% 20%, #0b1322, var(--shell-bg));
}

:host-context(.dark-theme) .shell.tenant-portal {
  --shell-bg: #071120;
  --sidebar-bg: #0b1628;
  --sidebar-gradient-to: #102139;
  --sidebar-active: #38bdf8;
}

:host-context(.dark-theme) .shell.control-plane {
  --shell-bg: #1a1310;
  --sidebar-bg: #221813;
  --sidebar-gradient-to: #2a1d16;
  --sidebar-active: #fb923c;
  --content-text: #f3f4f6;
}

.shell.no-session {
  grid-template-columns: 1fr;
}

.shell.no-legacy-sidebar {
  grid-template-columns: 1fr;
}

.sidebar {
  background: linear-gradient(180deg, var(--sidebar-bg) 0%, var(--sidebar-gradient-to) 100%);
  color: var(--sidebar-text);
  padding: 18px 14px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  border-right: 1px solid var(--border-color);
  position: sticky;
  top: 0;
  height: 100vh;
  overflow: hidden;
}

.sidebar.collapsed {
  padding: 14px 10px;
}

.theme-toggle-panel {
  position: fixed;
  top: 12px;
  right: 14px;
  z-index: 1200;
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 8px 10px;
  background: color-mix(in srgb, var(--sidebar-bg) 88%, transparent);
  backdrop-filter: blur(8px);
}

.brand {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.brand-row {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 8px;
}

.brand-text {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.sidebar-toggle-btn {
  border: 1px solid var(--border-color);
  background: color-mix(in srgb, var(--mks-surface) 88%, transparent);
  color: var(--sidebar-text);
  width: 34px;
  height: 34px;
  border-radius: 10px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex: 0 0 auto;
}

.sidebar-toggle-btn:hover {
  background: color-mix(in srgb, var(--mks-surface) 96%, transparent);
}

.brand strong {
  font-size: 1.25rem;
  letter-spacing: 0.02em;
}

.brand span {
  font-size: 0.85rem;
  color: var(--sidebar-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.session-meta {
  border: 1px solid color-mix(in srgb, var(--sidebar-active) 25%, var(--border-color));
  border-radius: 10px;
  padding: 10px;
  background: color-mix(in srgb, var(--mks-surface) 84%, transparent);
  backdrop-filter: blur(10px);
  font-size: 0.85rem;
}

:host-context(.dark-theme) .session-meta {
  background: rgba(15, 23, 42, 0.74);
}

.session-meta p {
  margin: 0 0 6px;
  color: var(--sidebar-text);
}

.session-meta p:last-child {
  margin-bottom: 0;
}

.menu {
  display: flex;
  flex-direction: column;
  gap: 6px;
  flex: 1 1 auto;
  overflow-y: auto;
  scrollbar-width: none;
  padding-right: 4px;
}

.menu::-webkit-scrollbar {
  width: 0;
  height: 0;
}

.menu-group {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-bottom: 6px;
}

.menu-group-title {
  margin: 8px 6px 2px;
  font-size: 0.74rem;
  font-weight: 800;
  letter-spacing: 0.07em;
  text-transform: uppercase;
  color: var(--sidebar-muted);
}

.menu a {
  --accent: var(--sidebar-active);
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--sidebar-text);
  text-decoration: none;
  border-radius: 12px;
  padding: 10px 10px;
  font-weight: 600;
  border: 1px solid transparent;
}

.menu .menu-icon {
  width: 1.25rem;
  height: 1.25rem;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: color-mix(in srgb, var(--accent) 14%, var(--mks-surface));
  color: color-mix(in srgb, var(--accent) 78%, #0f172a);
  border: 1px solid color-mix(in srgb, var(--accent) 34%, var(--mks-surface));
  flex: 0 0 auto;
  font-size: 0.82rem;
}

.menu .label {
  line-height: 1.1;
}

.menu a:hover {
  border-color: color-mix(in srgb, var(--accent) 35%, var(--border-color));
  background: color-mix(in srgb, var(--accent) 10%, var(--mks-surface));
}

.menu a.active {
  background: color-mix(in srgb, var(--accent) 16%, var(--mks-surface));
  border-color: color-mix(in srgb, var(--accent) 55%, var(--mks-surface));
  color: var(--sidebar-text);
}

.menu a.active .menu-icon {
  background: color-mix(in srgb, var(--accent) 20%, #ffffff);
  border-color: color-mix(in srgb, var(--accent) 62%, var(--mks-surface));
  color: color-mix(in srgb, var(--accent) 88%, #0f172a);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 14%, transparent);
}

.logout-btn {
  margin-top: auto;
  border: 1px solid var(--border-color);
  background: color-mix(in srgb, var(--mks-surface) 86%, transparent);
  color: var(--sidebar-text);
  border-radius: 10px;
  padding: 10px 12px;
  font-weight: 700;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.logout-btn:hover {
  background: color-mix(in srgb, var(--mks-surface) 100%, transparent);
}

:host-context(.dark-theme) .logout-btn {
  background: rgba(15, 23, 42, 0.9);
}

:host-context(.dark-theme) .logout-btn:hover {
  background: rgba(30, 41, 59, 0.95);
}

.sidebar.collapsed .brand-text,
.sidebar.collapsed .session-meta,
.sidebar.collapsed .menu-group-title,
.sidebar.collapsed .label,
.sidebar.collapsed .logout-label {
  display: none;
}

.sidebar.collapsed .brand-row {
  justify-content: center;
}

.sidebar.collapsed .menu a {
  justify-content: center;
  padding: 10px 8px;
}

.sidebar.collapsed .menu .menu-icon {
  margin: 0;
}

.sidebar.collapsed .logout-btn {
  padding: 10px;
}

.content {
  min-width: 0;
}

@media (max-width: 960px) {
  .shell {
    grid-template-columns: 1fr;
  }

  .theme-toggle-panel {
    top: 8px;
    right: 8px;
    padding: 6px 8px;
  }

  .sidebar {
    position: static;
    height: auto;
    overflow: visible;
    border-right: 0;
    border-bottom: 1px solid var(--border-color);
  }

  .menu {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    flex: 0 0 auto;
    overflow: visible;
    padding-right: 0;
  }

  .menu-group {
    display: contents;
  }

  .menu-group-title {
    grid-column: 1 / -1;
    margin-top: 10px;
  }

  .logout-btn {
    margin-top: 8px;
  }
}
