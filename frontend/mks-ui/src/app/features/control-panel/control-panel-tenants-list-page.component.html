<section class="tenants-list-wrap">
  <header class="page-header">
    <div>
      <h1>Tenants</h1>
      <p>Gestão e filtros avançados de tenants do SaaS.</p>
    </div>
    <a class="create-btn" routerLink="/control-panel/tenants/new">Novo Tenant</a>
  </header>

  <form class="filters" [formGroup]="filtersForm" (ngSubmit)="loadTenants()">
    <label>
      Status
      <select formControlName="status">
        <option value="">Todos</option>
        <option value="ACTIVE">ACTIVE</option>
        <option value="SUSPENDED">SUSPENDED</option>
        <option value="CANCELLED">CANCELLED</option>
        <option value="DELETED">DELETED</option>
      </select>
    </label>

    <label>
      Plano
      <select formControlName="planId">
        <option [ngValue]="null">Todos</option>
        <option *ngFor="let plan of plans()" [ngValue]="plan.id">
          {{ plan.name }} ({{ plan.tier }})
        </option>
      </select>
    </label>

    <label>
      Trial
      <select formControlName="trial">
        <option value="">Todos</option>
        <option value="true">Sim</option>
        <option value="false">Não</option>
      </select>
    </label>

    <label class="search">
      Buscar
      <input type="text" formControlName="search" placeholder="Nome/CNPJ/slug" />
    </label>

    <div class="actions">
      <button type="submit" [disabled]="loading()">Filtrar</button>
      <button type="button" class="secondary" (click)="clearFilters()" [disabled]="loading()">
        Limpar
      </button>
    </div>
  </form>

  <p class="error" *ngIf="error()">{{ error() }}</p>
  <p *ngIf="loading()">Carregando...</p>

  <table class="table" *ngIf="!loading()">
    <thead>
      <tr>
        <th>Tenant</th>
        <th>Status</th>
        <th>Plano</th>
        <th>Trial</th>
        <th>Contato</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let tenant of tenants()">
        <td>
          <strong>{{ tenant.legal_name }}</strong><br />
          <small>{{ tenant.slug }}.{{ tenant.subdomain }}</small><br />
          <small>{{ tenant.cnpj || "-" }}</small>
        </td>
        <td>{{ tenant.status }}</td>
        <td>{{ tenant.subscription?.plan?.name || "-" }}</td>
        <td>{{ tenant.subscription?.is_trial ? "Sim" : "Não" }}</td>
        <td>{{ tenant.contact_email || "-" }}</td>
        <td>
          <div class="actions">
            <a [routerLink]="['/control-panel/tenants', tenant.id]">Detalhes</a>
            <a [routerLink]="['/control-panel/tenants', tenant.id, 'edit']">Editar</a>
          </div>
        </td>
      </tr>
      <tr *ngIf="tenants().length === 0">
        <td colspan="6">Nenhum tenant encontrado com os filtros aplicados.</td>
      </tr>
    </tbody>
  </table>
</section>
