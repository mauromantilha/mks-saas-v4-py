<section style="max-width: 960px; margin: 24px auto; padding: 16px;">
  <h1>Painel RBAC por Tenant</h1>

  <div *ngIf="session()" style="display: grid; gap: 4px; margin-top: 12px;">
    <div><strong>Tenant:</strong> {{ session()?.tenantCode }}</div>
    <div><strong>Usuário:</strong> {{ session()?.username }}</div>
  </div>

  <div style="display: flex; gap: 8px; margin-top: 12px;">
    <button pButton type="button" (click)="load()" [disabled]="loading()">Carregar</button>
    <button pButton
      type="button"
      (click)="saveReplace()"
      [disabled]="loading() || !canEdit()"
    >
      Salvar (PUT)
    </button>
    <button pButton
      type="button"
      (click)="savePatch()"
      [disabled]="loading() || !canEdit()"
    >
      Salvar parcial (PATCH)
    </button>
  </div>

  <p *ngIf="role()" style="margin-top: 8px;">
    Role no tenant: <strong>{{ role() }}</strong>
    <span *ngIf="!canEdit()"> (somente leitura)</span>
  </p>

  <div style="margin-top: 16px;">
    <h2>rbac_overrides (editável)</h2>
    <textarea pInputTextarea
      rows="14"
      style="width: 100%; font-family: monospace;"
      [disabled]="!canEdit()"
      [ngModel]="editJson()"
      (ngModelChange)="editJson.set($event)"
    ></textarea>
  </div>

  <p *ngIf="loading()">Carregando...</p>
  <p *ngIf="error()" style="color: #b42318;">{{ error() }}</p>

  <div *ngIf="payload()" style="margin-top: 18px;">
    <h2>Resposta do backend</h2>
    <pre style="background: #f5f5f5; padding: 12px; overflow: auto;">{{ payload() | json }}</pre>
  </div>
</section>
